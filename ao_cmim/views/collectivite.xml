<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data>

		<!-- *************************************** Collectivites ************************************** -->
		<record id="partner_search_view" model="ir.ui.view">
			<field name="name">ao.res.partner.search</field>
			<field name="model">res.partner</field>
			<field name="inherit_id" ref="base.view_res_partner_filter" />
			<field name="arch" type="xml">

				<field name="name" position="after">
					<separator />
					<field name="code" string="Codes" domain-filter="[()'code', '=', self)]" />

				</field>
				<field name="parent_id" position="attributes">
					<attribute name="string"> Collectivité Mère</attribute>
				</field>
				
				<group name="group_by" position="inside">
					<filter name="secteur_id" string="Secteur" domain="[]"
						context="{'group_by':'secteur_id'}" />
				</group>
			</field>
		</record>
		<record id="view_partner_tree" model="ir.ui.view">
			<field name="name">cmim.collectivite.tree</field>
			<field name="model">res.partner</field>
			<field eval="7" name="priority" />
			<field name="inherit_id" ref="base.view_partner_tree" />
			<field name="arch" type="xml">
				<field name="display_name" position="replace"></field>
				<field name="phone" position="before">
					<field name="code" string="Code Collectivité" />
					<field name="name" string="Raison sociale" />
					<field name="date_adhesion" string="date d'adhesion" />
					<field name="secteur_id" string="Secteur" />
				</field>
			</field>
		</record>
		<record id="view_collectivite_form" model="ir.ui.view">
			<field name="name">cmim.collectivite.form</field>
			<field name="model">res.partner</field>
			<field name="inherit_id" ref="base.view_partner_form" />
			<field name="arch" type="xml">
				<button name="toggle_active" position="after">

					<button name="get_assures" type="object" class="oe_inline oe_stat_button"
						icon="fa-users">
						<field string="Assurés" name="assures_count" widget="statinfo" />
					</button>
					<button name="get_declarations" type="object" string="Déclarations"
						class="oe_inline oe_stat_button" icon="fa-align-justify" />
					<button name="import_declaration" type="object"
						string="Importer les déclarations" class="oe_inline oe_stat_button"
						icon="fa-level-up" />
					<button name="get_cotisations" type="object" string="Cotisations à valider"
						class="oe_inline oe_stat_button" icon="fa-sign-out" />
					<button name="get_payments" type="object" string="Réglements"
						class="oe_inline oe_stat_button" icon="fa-sign-in" />
				</button>
<!-- 				<xpath expr="//page[@name='sales_purchases']" position="before"> -->
<!-- 					<page string="Contrats / Adhésions"> -->
<!-- 						<group> -->
<!-- 							<field name="contrat_ids" nolabel="1"> -->
<!-- 								<form string="Contrats / adhesions"> -->
<!-- 									<group> -->
<!-- 										<group> -->
<!-- 											<field name="product_id" domain="[('type', '=', 'service')]" /> -->
<!-- 											<field name="name" /> -->
<!-- 										</group> -->
<!-- 										<group> -->
<!-- 											<field name="code" /> -->
<!-- 											<field name="type_product_id" readonly='1' /> -->
<!-- 											<field name="type_product_name" invisible='1' /> -->
<!-- 											<field name="tarif_id" -->
<!-- 												attrs="{'invisible': [('type_product_name','!=', 'MAL')]}" /> -->
<!-- 											<field name="tarif_inc_deces_id" -->
<!-- 												attrs="{'invisible': [('type_product_name','!=', 'PRV')]}" /> -->
<!-- 											<field name="tarif_inv_id" -->
<!-- 												attrs="{'invisible': [('type_product_name','!=', 'PRV')]}" /> -->
<!-- 										</group> -->
<!-- 									</group> -->
<!-- 									<label for="name" /> -->
<!-- 									<field name="name" /> -->
<!-- 								</form> -->
<!-- 								<tree string="Contrats / dhesions" editable="bottom"> -->
<!-- 									<field name="product_id" domain="[('type', '=', 'service')]" /> -->
<!-- 									<field name="name" /> -->
<!-- 									<field name="code" /> -->
<!-- 									<field name="type_product_id" /> -->
<!-- 									<field name="tarif_id" /> -->
<!-- 									<field name="tarif_inc_deces_id" /> -->
<!-- 									<field name="tarif_inv_id" /> -->
<!-- 								</tree> -->
<!-- 							</field> -->
<!-- 						</group> -->
<!-- 					</page> -->
<!-- 				</xpath> -->
				<page name='sales_purchases' position="attributes">
					<attribute name="invisible">True</attribute>
				</page>
				<field name="is_company" position="attributes">
					<attribute name="readonly">True</attribute>
				</field>
				<field name="website" position="replace"> </field>
				<field name="company_type" position="attributes">
					<attribute name="readonly">True</attribute>
				</field>
				<field name="customer" position="attributes">
					<attribute name="readonly">True</attribute>
				</field>
				<field name="supplier" position="attributes">
					<attribute name="readonly">True</attribute>
				</field>
				<h1 position="replace">
					<h1>
						<field name="name" default_focus="1" placeholder="Raison Sociale"
							attrs="{'required' : [('type', '=', 'contact')]}" />
					</h1>

					<h5>
						<div>
							<label for="code" class="oe_inline" string="Code" />
							<field name="code" class="oe_inline" nolabel="1" />
						</div>
						<!-- <h2> -->
						<!-- <field name="code" placeholder="Code Collectivité" -->
						<!-- attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', 
							False)]}" /> -->
					</h5>
				</h1>
				<xpath expr="//label[@for='street']" position="before">
					<field name="secteur_id"
						attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)]}" />
					<field name="parent_id" string="Collectivité mère"
						attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)]}" />
					<field name="date_adhesion"
						attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)]}" />
					<field name="contrat_id"
						attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)]}" />
				</xpath>
			</field>
		</record>

		<!-- ************************************ action *************************************** -->

		<record id="action_collectivite" model="ir.actions.act_window">
			<field name="name">Collectivités</field>
			<field name="res_model">res.partner</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form,kanban</field>
			<field name="domain" eval="[('customer','=',True),('is_company','=',True)]" />
			<field name="context">{}</field>
<!-- 			"search_default_secteur_id":1 -->
			<field name="view_id" ref="base.res_partner_kanban_view" />
			<field name="search_id" ref="partner_search_view" />
		</record>

	</data>
</odoo>
